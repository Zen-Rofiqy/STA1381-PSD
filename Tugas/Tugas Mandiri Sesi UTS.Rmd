---
title: "Analisis Regresi Klasik, Ridge, dan Lasso"
author: "Angga Fathan Rofiqy"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: hide
    toc_depth: 3
    number_sections: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
pkgdown:
  as_is: true
---

```{r, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}
```

```{r, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#Function biar gak perlu ganti backslash (\) jadi slash (/).
path <- function() gsub  ( "\\\\",  "/",  readClipboard ()  )
#Copy path, Panggil function di console
#Copy r path, paste ke var yang diinginkan
```

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#Set Working Directory
require("knitr")
opts_knit$set(root.dir = "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 5/8. Pengantar Sains Data/Tugas")
```

\newpage

# Pendahuluan

![](https://wallpaperwaifu.com/wp-content/uploads/2023/06/ferrari-f8-tributo-thumb.jpg)

**Link Github :**

## Tentang Data

**mtcars Dataset**

Dataset mtcars berisi informasi tentang berbagai spesifikasi mobil berdasarkan model dan tahun pembuatannya. Dataset ini digunakan sebagai contoh dalam banyak analisis dan pemodelan statistik.

## Tujuan

-   Membuat analisis regresi klasik, ridge, dan lasso.

-   Membandingkan performa model, peubah yang digunakan.

-   Interpretasi koefisien model terbaiknya.

## Peubah

Terdapat 11 peubah yang terdiri dari:

| **Peubah** |                **Keterangan**                | **Sebagai Peubah** | **Tipe Peubah** |
|:-----------:|:-------------------------------:|-------------|-------------|
|   `mpg`    |     Jarak tempuh per gallon bahan bakar.     | `y`                | Numerik         |
|   `cyl`    |               Jumlah silinder.               | `x1`               | Numerik         |
|   `disp`   |       Volume mesin (dalam inci kubik).       | `x2`               | Numerik         |
|    `hp`    |                 Tenaga kuda.                 | `x3`               | Numerik         |
|   `drat`   |          Rasio akselerasi belakang.          | `x4`               | Numerik         |
|    `wt`    |      Berat kendaraan (dalam 1000 pon).       | `x5`               | Numerik         |
|   `qsec`   |         Waktu tempuh seperempat mil.         | `x6`               | Numerik         |
|    `vs`    |  Jenis mesin (0 = V-shaped, 1 = straight).   | `x7`               | Kategorik       |
|    `am`    | Jenis transmisi (0 = automatic, 1 = manual). | `x8`               | Kategorik       |
|   `gear`   |                 Jumlah gigi.                 | `x9`               | Numerik         |
|   `carb`   |              Jumlah karburator.              | `x10`              | Numerik         |

### Data Preparation {.tabset}

#### Data input

```{r, warning=FALSE, message = FALSE}
raw.data <- mtcars
data <- raw.data
install_load('DT')
datatable(raw.data, filter = 'top', 
          options = list(pageLength = 5))
```

Data ini memiliki 32 baris atau amatan.

#### Data Checking

```{r}
str(data)
```

Peubah `vs` dan `am` harus berupa kategorik. Namun bisa langsung dijadikan sebagai factor agar menjadi peubah dummy.

```{r}
sum(is.na(data))
```

Tidak ada data kosong dalam data ini.

#### Data Cleaning

```{r, warning=FALSE, message = FALSE}
install_load('dplyr')
data <- raw.data %>%
  mutate(
    am = factor(ifelse(am == 0, "Automatic", "Manual")),
    vs = factor(ifelse(vs == 0, "Rear-Wheel Drive", "Front-Wheel Drive"))
  )
str(data)
```

```{r}
levels(data$am); levels(data$vs)
```

Peubah `vs` dan `am` sudah menjadi peubah dummy. Namun saya ingin mengubah referensi kategorinya dengan kategori terbanyak.

```{r}
datatable(cbind(data %>% count(am), data %>% count(vs)))
```

Kategori referensi untuk peubah `am` sudah benar, yakni *'Automatic'* dan untuk peubah `vs` adalah '*Rear-Wheel Drive'.*

```{r}
install_load('forcats')
data <- data %>% 
  mutate(am = fct_relevel(am, levels(data$am)[which.max(table(data$am))] ),
         vs = fct_relevel(vs, levels(data$vs)[which.max(table(data$vs))] ) )
levels(data$am); levels(data$vs)
```

Kategori referensi sudah di setting ulang.

# Regresi Klasik {.tabset}

![](images/Asset 1@72x.png)

## Model

```{r}
reg.klas <- lm(mpg ~ cyl + disp + hp + drat + wt + qsec + vs + am + gear + carb, data=data)
summary(reg.klas)
```

Diperoleh model dugaan :

$$\begin{equation}
\begin{aligned}
\hat{\text{mpg}}_i = & 12.30337 -0.11144 \cdot \text{cyl} + 0.01334 \cdot \text{disp} - 0.02148 \cdot \text{hp} + 0.78711 \cdot \text{drat} - 3.71530 \cdot \text{wt} \\
            & + 0.82104 \cdot \text{qsec} + 0.31776 \cdot \text{vsFront-Wheel Drive} + 2.52023 \cdot \text{amManual} + 0.65541 \cdotÂ \text{gear} \\ & - 0.19942 \cdot \text{carb} + \epsilon_i
\end{aligned}
\end{equation}
$$

### Interpretasi {.tabset}

#### Coefficients:

1.  **Intercept (Intersep):**\
    Koefisien Intercept adalah $12.30337$. Ini adalah nilai y ketika semua variabel independen (`cyl,` `disp`, `hp`, `drat`, `w`t, `qsec`, `vs`, `am`, `gear`, `carb`) adalah nol. Dalam konteks ini, tidak ada interpretasi praktis karena nilai-nilai nol untuk variabel-variabel independen biasanya tidak relevan dalam kasus ini.

2.  **cyl (Cylinder):**\
    Koefisien untuk variabel independen **`cyl`** adalah $-0.11144$. Ini menunjukkan bahwa dengan **setiap penambahan** satu unit pada jumlah silinder, rata-rata miles per gallon (mpg) cenderung **berkurang** sebesar $-0.11144$ unit, tetapi perubahan ini **tidak signifikan** secara statistik.

3.  **disp (Displacement):**\
    Koefisien untuk variabel independen **`disp`** adalah $0.01334$. Ini mengindikasikan bahwa dengan **setiap penambahan** satu unit pada volume mesin, rata-rata mpg cenderung **meningkat** sebesar $0.01334$ unit, tetapi perubahan ini juga **tidak signifikan** secara statistik.

4.  **hp (Horsepower):**\
    Koefisien untuk variabel independen **`hp`** adalah $-0.02148$. Ini menunjukkan bahwa dengan **setiap penambahan** satu unit pada tenaga kuda, rata-rata mpg cenderung berkurang sebesar $-0.02148$ unit, tetapi perubahan ini juga **tidak signifikan** secara statistik.

5.  **drat (Rear Axle Ratio):**\
    Koefisien untuk variabel independen **`drat`** adalah $0.78711$. Ini berarti bahwa dengan **setiap peningkatan** satu unit pada rasio poros belakang, rata-rata mpg cenderung **meningkat** sebesar $0.78711$ unit. Namun, perubahan ini juga **tidak signifikan** secara statistik.

6.  **wt (Weight):**\
    Koefisien untuk variabel independen **`wt`** adalah $-3.71530$. Ini mengindikasikan bahwa dengan **setiap penambahan** satu unit pada berat kendaraan, rata-rata mpg cenderung **berkurang** sebesar $-3.71530$ unit. Koefisien ini memiliki **nilai t yang signifikan** secara statistik, yang berarti bahwa berat kendaraan memiliki pengaruh yang signifikan terhadap mpg.

7.  **qsec (Quarter Mile Time):**\
    Koefisien untuk variabel independen **`qsec`** adalah $0.82104$. Ini menunjukkan bahwa dengan **setiap peningkatan** satu unit pada waktu tempuh seperempat mil, rata-rata mpg cenderung **meningkat** sebesar $0.82104$ unit, tetapi perubahan ini **tidak signifikan** secara statistik.

8.  **vs (V/S):**\
    Koefisien untuk variabel independen **`vs`** adalah $0.31776$. Ini mengindikasikan bahwa jika jenis mesin adalah V/S, rata-rata mpg cenderung lebih tinggi sekitar $0.31776$ unit dibandingkan dengan jenis mesin lainnya. Namun, efek ini juga **tidak signifikan** secara statistik.

9.  **am (Transmisi):**\
    Koefisien untuk variabel independen **`am`** adalah $2.52023$. Ini berarti bahwa jika transmisi adalah otomatis (am=1), rata-rata mpg cenderung lebih tinggi sekitar $2.52023$ unit dibandingkan dengan transmisi manual (am=0). Koefisien ini memiliki pengaruh yang **tidak signifikan** terhadap mpg.

10. **gear (Gigi):**\
    Koefisien untuk variabel independen **`gear`** adalah $0.65541$. Ini menunjukkan bahwa jika jumlah gigi adalah 1 unit lebih tinggi, rata-rata mpg cenderung lebih tinggi sekitar $0.65541$ unit. Namun, perubahan ini **tidak signifikan** secara statistik.

11. **carb (Karburator):**\
    Koefisien untuk variabel independen **`carb`** adalah $-0.19942$. Ini mengindikasikan bahwa dengan setiap penambahan satu unit pada jumlah karburator, rata-rata mpg cenderung berkurang sebesar $-0.19942$ unit, tetapi perubahan ini juga tidak signifikan secara statistik.

#### **Residual Standard Error** (Residual SE atau RSE):

Residual SE mengukur seberapa jauh perbedaan antara nilai-nilai aktual (data sebenarnya) dan nilai-nilai yang diprediksi oleh model (data yang diestimasi oleh model). Ini adalah estimasi dari deviasi standar dari residual (kesalahan prediksi) dalam model. **Semakin kecil nilai RSE**, **semakin baik** model memfitting data. RSE yang diperoleh adalah sekitar $2.65$, yang mengindikasikan bahwa rata-rata residual sekitar $2.65$ unit dari nilai aktual.

#### **Multiple R-squared** (R-squared):

R-squared mengukur seberapa baik variabilitas dalam variabel respons (dalam hal ini, **`mpg`**) dapat dijelaskan oleh model. Nilai R-squared berkisar antara 0 hingga 1, di mana 0 berarti model tidak menjelaskan variasi sama sekali dan 1 berarti model menjelaskan semua variasi. Nilai R-squared sebesar $0.869$ mengindikasikan bahwa **sekitar** $86.9\%$ variabilitas dalam **`mpg`** **dapat dijelaskan** oleh variabel-**variabel independen** dalam model.

#### **Adjusted R-squared**:

Adjusted R-squared adalah modifikasi dari R-squared yang mempertimbangkan jumlah variabel independen dalam model. Ini adalah ukuran yang **lebih kritis** karena memasukkan kompleksitas model. Nilai Adjusted R-squared sebesar $0.8066$ menunjukkan bahwa sekitar $80.66\%$ variabilitas dalam **`mpg`** d**apat dijelaskan** oleh variabel-**variabel independen** dalam model, dengan mempertimbangkan **kompleksitas model**.

#### **F-statistic**:

F-statistic adalah statistik yang digunakan untuk menguji apakah model regresi secara keseluruhan signifikan atau tidak. **Semakin tinggi** nilai **F-statistic** dan **semakin rendah** nilai **p-value** yang terkait, **semakin signifikan** model regresi secara keseluruhan. F-statistic yang diperoleh sebesar $13.93$ dan nilai *p-value* yang sangat rendah ($3.793\times10^{-7}$) menunjukkan bahwa model diatas secara keseluruhan adalah model yang **signifikan** secara statistik, yang berarti bahwa setidaknya salah satu variabel independen memiliki efek signifikan pada variabel respons (**`mpg`**) dalam model ini.

#### Simpulan

Hasil dari koefisien regresi menunjukkan bahwa variabel `wt` (berat kendaraan) memiliki **pengaruh negatif yang kuat** terhadap `mpg` (*mileage per gallon*).

> Ini berarti **semakin berat** kendaraan, **semakin rendah efisiensi** bahan bakarnya.

# Regresi Ridge

# Regresi Lasso
