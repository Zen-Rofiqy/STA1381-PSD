---
title: "Visualisasi dan Eksplorasi Data PSD Kel 3"
author: "Angga Fathan Rofiqy"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: hide
    toc_depth: 3
    number_sections: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
pkgdown:
  as_is: true
---

```{r, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
path <- function() gsub  ( "\\\\",  "/",  readClipboard ()  )
#Copy path, Panggil function di console
#Copy r path, paste ke var yang diinginkan
```

```{r setup, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
require("knitr")
opts_knit$set(root.dir = "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 5/8. Pengantar Sains Data/Proj")
```

```{r}
#Export chart
export.chart <- "C:/Users/Fathan/Documents/Obsidian Vault/2. Kuliah/Smt 5/8. Pengantar Sains Data/Proj/Chart"
```

```{r, include=FALSE, echo=FALSE, warning=FALSE, message = FALSE}
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}
```

### Data Input

```{r, warning=FALSE, message = FALSE}
install_load('readxl','dplyr','kableExtra','DT')
raw.data <- read_xlsx("managed.xlsx", sheet="Data")
data <- raw.data

datatable(raw.data, filter = 'top', 
          options = list(pageLength = 5))
```

# Brand Laptop {.tabset}

![](https://media.licdn.com/dms/image/D5612AQE5uZNqFhkoZw/article-cover_image-shrink_720_1280/0/1681661151014?e=2147483647&v=beta&t=3Vb9PptDBLu_JtHDiHlJNslfx3PrbLzwnSZDdVZKBe0)

```{r,include=FALSE, echo=FALSE, message = FALSE, warning=FALSE}
install_load('ggplot2')
theme1.1 <- list(
  geom_hline(yintercept = 0, size = 1, colour="#333333"),
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold"), # Tambahkan label
  theme(axis.text.x = element_text(angle = 45, hjust = 1, 
                                   margin = margin(b = 10, t=-20)),
        axis.text.y = element_text(vjust = 0.5, face = "bold", 
                                   margin = margin(l = 20, r = 0)),
        plot.title = element_text(hjust = 0.5, face = "bold"),
        text = element_text(size = 30),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'transparent'),
        plot.background = element_rect(fill='transparent', color=NA),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()
        ) 
)
theme1.2 <- list(
  geom_hline(yintercept = 0, size = 1, colour="#333333"),
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), hjust = -0.5, size = 8, col="orange4", 
            fontface = "bold"), # Tambahkan label
  theme(axis.text.x = element_text(angle = 45, hjust = 1, 
                                   margin = margin(b = 10)),
        axis.text.y = element_text(vjust = 0.5, face = "bold", 
                                   margin = margin(l = 20, r = -90)),
        plot.title = element_text(hjust = 0.5, face = "bold"),
        text = element_text(size = 30),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'transparent'),
        plot.background = element_rect(fill='transparent', color=NA),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()
        ) 
)
```

## Bar Chart Vertikal

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>% count(Brand) %>% # banyaknya laptop brand x
  mutate(perc = round(n / sum(n) * 100)) 
chart <-
ggplot(data = gg.data, #buat persentase
       aes(x = reorder(Brand, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill= ifelse(gg.data$Brand == "HP",  "#1380A1", "#dddddd")) +
  labs(x = "\nBrand", y = "Persentase (%)", 
       title = "Sebaran Brand Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) + theme1.1
  
chart 
#Export Chart
ggsave("01.1_Sebaran Brand Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Bar Chart Horizontal

```{r dpi=300, fig.height = 20, fig.width = 17, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data, #buat persentase
       aes(x = reorder(Brand, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill= ifelse(gg.data$Brand == "HP",  "#1380A1", "#dddddd")) +
  labs(x = "\nBrand", y = "Persentase (%)", 
       title = "Sebaran Brand Laptop\n") + coord_flip() +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 5)) + theme1.2 
  
chart 
#Export Chart
ggsave("01.2_Sebaran Brand Laptop.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 17)
```

# Harga {.tabset}

```{r,include=FALSE, echo=FALSE, message = FALSE, warning=FALSE}
theme2 <- list(
  theme(axis.text.x = element_text(angle = 45, hjust = 1, 
                                   margin = margin(b = 10, t=0)),
        axis.text.y = element_text(vjust = 0.5, face = "bold", 
                                   margin = margin(l = 20, r = -40)),
        plot.title = element_text(hjust = 0.5, face = "bold"),
        text = element_text(size = 30),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'transparent'),
        plot.background = element_rect(fill='transparent', color=NA),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank()
        ) 
)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran Harga

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
install_load('ggtext')
chart <-
ggplot(data, aes(x=`Price (IDR)`/1000, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#fdbe4a', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#0B6260', color='black',
                     outlier.size=2, outlier.color='#0B6260', 
                     notch=T, width=0.2) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nHarga (Ribu IDR)", y='',
       title = "Sebaran Harga Brand Laptop") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`Price (IDR)`) / 1000, y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`Price (IDR)`) / 1000, 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#0B6260", 
    fill = "white", box.color = "#0B6260", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`Price (IDR)`) / 1000, 
                   xend = mean(data$`Price (IDR)`) / 1000, 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("02.1_Sebaran Harga Laptop.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran Harga Per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
install_load('ggridges','viridis')
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`Price (IDR)`/1000, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.75, #Opacity
                     begin = 0.5, #Color pallte scale begins
                     end = 0.9, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "B") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nHarga (Ribu IDR)",y = "Brand Laptop\n", 
       title = "Sebaran Harga Brand Laptop \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7, fill=NA
)

chart
#Export Chart
ggsave("02.2_Sebaran Harga Laptop .png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

# Storage {.tabset}

![](https://ventraip.com.au/wp-content/uploads/2021/04/hdd-ssd.jpg)

```{r,include=FALSE, echo=FALSE, message = FALSE, warning=FALSE}
theme3 <- list(
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"),
        text = element_text(size = 30),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'transparent', color=NA),
        plot.background = element_rect(fill='transparent', color=NA)
        ) 
)
theme3.2 <- list(
  theme(legend.position = "none",
        plot.title = element_text(hjust = 0.5, face = "bold"),
        text = element_text(size = 30),
        plot.subtitle = element_text(hjust = 0.5),
        panel.background = element_rect(fill = 'transparent', color=NA),
        plot.background = element_rect(fill='transparent', color=NA),
        panel.grid.major = element_line(colour = "grey90"),
        axis.line = element_line(linewidth = 1.5, colour = "black")
        ) 
)
```

## Pie Chart, Proporsi HDD dan SSD

```{r dpi=300, fig.height = 14, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
install_load('stringr','ggrepel')
data <- data %>% 
  mutate(`Storage (GB)` = as.numeric(str_extract(Storage, "\\d+")),
         `Storage Type` = str_extract(Storage, "(SSD|HDD)"))  
gg.data <- data %>%
  group_by(`Storage Type`) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

# Buat pie chart
chart <- 
ggplot(gg.data, aes(x = "", y = count, fill = `Storage Type`)) +
  geom_bar(stat = "identity", col=NA) +
  geom_label_repel(aes(label = paste0(`Storage Type`, "\n", 
                                    round(count / sum(count) * 100), 
                                    "% (", count, ")" ) ), 
                  position = position_stack(vjust = 0.5), size = 10,
                  label.padding = unit(1, "lines"), col="white") +
  coord_polar(theta = "y") +
  scale_fill_manual(values =c(SSD = "#3788A1", HDD = "#504E58")) +
  theme_void() +
  labs(title = "\nProporsi SSD dan HDD") + theme3
chart 

#Export Chart
ggsave("03.1_Proporsi SSD dan HDD.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 14)
```

## Bar Chart SSD

![](https://www.itechtics.com/wp-content/uploads/2014/11/4-Ways-To-Determine-The-Type-Of-Drive-HDD-or-SSD-Installed-In-Your-Computer.jpg)

### Variasi {.tabset}

#### Tidak Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
        filter(grepl("SSD", `Storage Type`, ignore.case = TRUE)) %>% 
            count(`Storage (GB)`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top3 = row_number() <= 3) # Top 3 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, `Storage (GB)`), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top3,  c("#3788A1", "#5494A3", "#65AEB9"),
                         "#dddddd")
           ) + 
  labs(x = "SSD (GB)", y = "Persentase (%)\n", 
       title = "Sebaran SSD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart 
#Export Chart
ggsave("03.2_Sebaran SSD Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top3,  c("#3788A1", "#5494A3", "#65AEB9"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nSSD (GB)", y = "Persentase (%)\n", 
       title = "Sebaran SSD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("03.3_Sebaran SSD Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top3,  c("#3788A1", "#5494A3", "#65AEB9"),
                         "#dddddd")
           ) +
  labs(x = "SSD (GB)", y = "Persentase (%)", 
       title = "Sebaran SSD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 4)) +
  theme1.2 + coord_flip()
chart 
#Export Chart
ggsave("03.4_Sebaran SSD Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 14)
```

## Bar Chart HDD

![](https://www.itechtics.com/wp-content/uploads/2014/11/4-Ways-To-Determine-The-Type-Of-Drive-HDD-or-SSD-Installed-In-Your-Computer.jpg)

### Variasi {.tabset}

#### Tidak Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
        filter(grepl("HDD", `Storage Type`, ignore.case = TRUE)) %>% 
            count(`Storage (GB)`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, `Storage (GB)`), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#3788A1"),
                         "#dddddd")
           ) + 
  labs(x = "HDD (GB)", y = "Persentase (%)\n", 
       title = "Sebaran HDD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart 
#Export Chart
ggsave("03.5_Sebaran HDD Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#3788A1"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nHDD (GB)", y = "Persentase (%)\n", 
       title = "Sebaran HDD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("03.6_Sebaran HDD Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Storage (GB)`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#3788A1"),
                         "#dddddd")
           ) +
  labs(x = "HDD (GB)", y = "Persentase (%)", 
       title = "Sebaran HDD Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 9)) +
  theme1.2 + coord_flip()
chart 
#Export Chart
ggsave("03.7_Sebaran HDD Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 14)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran Storage Score

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
install_load('ggtext')
chart <-
ggplot(data, aes(x=`Storage Score`, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#3788A1', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#504E58', color='black',
                     outlier.size=2, outlier.color='#504E58', 
                     notch=T, width=0.2) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nStorage Score", y='',
       title = "Sebaran Storage Score") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`Storage Score`), y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`Storage Score`) , 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#504E58", 
    fill = "white", box.color = "#504E58", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`Storage Score`) , 
                   xend = mean(data$`Storage Score`) , 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("03.8_Sebaran Storage Score.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran Storage Score Per Tipe

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$`Storage Type` <- factor(data$`Storage Type`, 
                  levels= data %>% count(`Storage Type`) %>% 
                                        arrange(n, desc(`Storage Type`)) %>%
                                        pull(`Storage Type`) )
chart <- 
ggplot(data, aes(x=`Storage Score`, y=`Storage Type`, fill=`Storage Type`)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_manual(values =c(SSD = "#3788A1", HDD = "#504E58")) +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nStorage Score",y = "Tipe Storage\n", 
       title = "Sebaran Storage Score Per Tipe\n") + theme2 


chart
#Export Chart
ggsave("03.9_Sebaran Storage Score Per Tipe.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran Storage Score Per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`Storage Score`, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.75, #Opacity
                     begin = 0.1, #Color pallte scale begins
                     end = 0.9, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "G") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nHarga (Ribu IDR)",y = "Brand Laptop\n", 
       title = "Sebaran Storage Score \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7, fill=NA
)

chart
#Export Chart
ggsave("03.10_Sebaran Storage Score Laptop .png", 
       chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Scatterplot Storage Score & Price

```{r dpi=300, fig.height = 20, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = data, aes(x = `Storage Score`, y = `Price (IDR)`/1000, color = `Storage Type`)) +
  geom_point(alpha = 0.5, size = 7, col="#3788A1") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 0.5) +
  labs(title='Scatterplot Storage Score dengan Price\n',
    x = "\nStorage Score", y = "Ribu IDR\n", color = "Storage Type") +
  theme3.2 +
  geom_text(aes(x = 30000, 
                y = 100000, 
                label = paste("R =", round(cor(data$`Storage Score`, 
                                               data$`Price (IDR)`), 2))),
            color = "black", size = 20)
chart
#Export Chart
ggsave("03.11_Scatteplot Storage Score degan Price.png", 
       chart, path = export.chart,
        dpi = 300, height = 20, width = 20)
```

# Display {.tabset}

![](https://assets2.razerzone.com/images/pnx.assets/b860fdc473e861a943ee9a026125ac88/display-screen-technology-hero-desktop.jpg)

Pisahkan data.

```{r, message = FALSE, warning=FALSE}
data <- data %>%
  separate(Display, into = c("Screen Size (Inch)", "Resolution", 
                             "Screen Type","Refresh Rate (Hz)" ), 
           sep = ", ", remove = FALSE) %>%
  mutate(
    # Menghapus karakter " dan mengubah menjadi numerik
    `Screen Size (Inch)` = as.numeric(gsub("[^0-9.]", "", `Screen Size (Inch)`)), 
    #Tukar Kolom jika ada hz
    temp = `Refresh Rate (Hz)`,
    #Ubah hz jadi numerik
    `Refresh Rate (Hz)` = ifelse(grepl("Hz", `Screen Type`), 
                                 as.numeric(gsub("[^0-9.]", "", `Screen Type`)), 
                      #Jika tidak ada, beri nilai minimal hz laptop yakni 60 hz
                                 60), 
    `Screen Type` = ifelse(grepl("Hz", `Screen Type`), temp, `Screen Type`)
  ) %>% select(-temp) %>% 
  mutate(`Screen Type` = ifelse(is.na(`Screen Type`), "LCD", `Screen Type`))
```

## Bar Chart Screen Size

![](https://pop.h-cdn.co/assets/17/01/4000x2000/landscape-1483651026-img-20170105-114151.jpg)

### Variasi {.tabset}

#### Tidak Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`Screen Size (Inch)`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Screen Size (Inch)`, `Screen Size (Inch)`), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nScreen Size", y = "Persentase (%)\n", 
       title = "Bar Chart Screen Size Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("04.1_Bar Chart Screen Size Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Screen Size (Inch)`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nScreen Size", y = "Persentase (%)\n", 
       title = "Bar Chart Screen Size Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1 
chart
#Export Chart
ggsave("04.2_Bar Chart Screen Size Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Bar Chart Resolution

![](https://allthedifferences.com/wp-content/uploads/2022/05/viktor-yevenko-dRs6GoGCoXs-unsplash-1250x938.jpg)

```{r}
data <- data %>% 
  mutate( # Mencari semua kemungkinan pasangan angka dalam kolom "Resolution"
    Resolution_Num = str_extract_all(Resolution, "\\d{2,}"),
    # Mengambil pasangan angka yang memiliki dua angka di dalamnya
    Resolution_Num = sapply(Resolution_Num, 
                            function(x) if (length(x) == 2) paste(x, collapse = "x") else NA)
  ) %>% # Pisahkan "Width" dan "Height" dari "Resolution_Num"
  separate(Resolution_Num, into = c("Width", "Height"), sep = "x", 
           convert = TRUE, remove = FALSE) %>% 
# Berikan bobot jika ada kata PixelSense dalam kolom resolusi
  mutate(
    Resolution = ifelse(grepl("PixelSense", Resolution), 
                              Width * Height * 1.125, 
                              Width * Height)
  ) %>% select(-Resolution_Num, -Width, -Height) 
```

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(Resolution) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(Resolution, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nResolution", y = "Persentase (%)\n", 
       title = "Bar Chart Resolution Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("04.3_Bar Chart Resolution Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Bar Chart Screen Type

![](https://id-media.apjonlinecdn.com/magefan_blog/1000x450px_Benefits_of_Using_Touch_Screen_Pen.jpg)

### Variasi {.tabset}

#### Vertikal

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`Screen Type`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Screen Type`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nScreen Type", y = "Persentase (%)\n", 
       title = "Bar Chart Screen Type Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("04.4_Bar Chart Screen Type Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Screen Type`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  labs(x = "Screen Type", y = "Persentase (%)", 
       title = "Bar Chart Screen Type Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 9)) +
  theme1.2 + coord_flip()
chart 
#Export Chart
ggsave("04.5_Bar Chart Screen Type Laptop_Horizontal.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 14)
```

## Bar Chart Refresh Rate

![](https://www.notebookcheck.net/fileadmin/Notebooks/News/_nc3/asus_360hz.jpg)

### Variasi {.tabset}

#### Tidak Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`Refresh Rate (Hz)`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Refresh Rate (Hz)`, `Refresh Rate (Hz)`), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nRefresh Rate (Hz)", y = "Persentase (%)\n", 
       title = "Bar Chart Refresh Rate Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("04.6_Bar Chart Refresh Rate (Hz) Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Refresh Rate (Hz)`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nRefresh Rate (Hz)", y = "Persentase (%)\n", 
       title = "Bar Chart Refresh Rate Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("04.7_Bar Chart Refresh Rate (Hz) Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Refresh Rate (Hz)`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#6F3E98"),
                         "#dddddd")
           ) +
  labs(x = "Refresh Rate (Hz)", y = "Persentase (%)", 
       title = "Bar Chart Refresh Rate Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 9)) +
  theme1.2 + coord_flip()
chart 
#Export Chart
ggsave("04.8_Bar Chart Refresh Rate (Hz) Laptop_Horizontal.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 14)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran Display Score

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data, aes(x=`Display Score`, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#6F3E98', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#65AEB9', color='black',
                     outlier.size=2, outlier.color='#65AEB9', 
                     notch=T, width=0.1) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nDisplay Score", y='',
       title = "Sebaran Display Score Laptop") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`Display Score`) , y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`Display Score`) , 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#65AEB9", 
    fill = "white", box.color = "#65AEB9", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`Display Score`) , 
                   xend = mean(data$`Display Score`) , 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("04.9_Sebaran Display Score Laptop.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran Display Score Per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`Display Score`, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.75, #Opacity
                     begin = 0.1, #Color pallte scale begins
                     end = 0.5, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "A") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nHarga (Ribu IDR)",y = "Brand Laptop\n", 
       title = "Sebaran Harga Brand Laptop \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7, fill=NA
)

chart
#Export Chart
ggsave("04.10_Sebaran Display Score Laptop .png", 
       chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Scatterplot Display Score & Price

```{r dpi=300, fig.height = 20, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = data, aes(x = `Display Score`, y = `Price (IDR)`/1000)) +
  geom_point(alpha = 0.5, size = 7, col="#6F3E98") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 0.5) +
  labs(title='Scatterplot Display Score dengan Price\n',
    x = "\nDisplay Score", y = "Ribu IDR\n", color = "Storage Type") +
  theme3.2 +
  geom_text(aes(x = 150, 
                y = 100000, 
                label = paste("R =", round(cor(data$`Display Score`, 
                                               data$`Price (IDR)`), 2))),
            color = "black", size = 20)
chart
#Export Chart
ggsave("04.5_Scatteplot Display Score degan Price.png", 
       chart, path = export.chart,
        dpi = 300, height = 20, width = 20)
```

# RAM {.tabset}

![](https://blog-asset.jakmall.com/blog/content/images/2019/05/Jakmall_Apr2019_Article13_RAM-DDR3-8GB-Laptop-Bekas-min.jpg)

## Bar Chart RAM

### Variasi {.tabset}

#### Tidak Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`Ram (GB)`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Ram (GB)`, `Ram (GB)`), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#008881"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nRam (GB)", y = "Persentase (%)\n", 
       title = "Bar Chart Refresh Rate Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("05.1_Bar Chart Ram (GB) Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Urut

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Ram (GB)`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#008881"),
                         "#dddddd")
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nRAM (GB)", y = "Persentase (%)\n", 
       title = "Bar Chart RAM Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("05.2_Bar Chart Ram (GB) Laptop_Urut.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 14, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`Ram (GB)`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$top1,  c("#008881"),
                         "#dddddd")
           ) +
  labs(x = "RAM (GB)", y = "Persentase (%)", 
       title = "Bar Chart RAM Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 9)) +
  theme1.2 + coord_flip()
chart 
#Export Chart
ggsave("05.3_Bar Chart Ram (GB) Laptop_Horizontal.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 14)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran RAM

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data, aes(x=`Ram (GB)`, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#008881', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#C29F45', color='black',
                     outlier.size=2, outlier.color='#C29F45', 
                     notch=T, width=0.1) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nRam (GB) Score", y='',
       title = "Sebaran Ram Laptop") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`Ram (GB)`) , y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`Ram (GB)`) , 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#C29F45", 
    fill = "white", box.color = "#C29F45", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`Ram (GB)`) , 
                   xend = mean(data$`Ram (GB)`) , 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("05.4_Sebaran Ram (GB) Laptop.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran RAM Per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`Ram (GB)`, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.9, #Opacity
                     begin = 0.4, #Color pallte scale begins
                     end = 1, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "G") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nRAM (GB)",y = "Brand Laptop\n", 
       title = "Sebaran RAM Laptop \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7, fill=NA
)

chart
#Export Chart
ggsave("05.5_Sebaran RAM (GB) Per Brand Laptop.png", 
       chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Scatterplot RAM & Price

```{r dpi=300, fig.height = 20, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = data, aes(x = `Ram (GB)`, y = `Price (IDR)`/1000)) +
  geom_point(alpha = 0.5, size = 7, col="#008881") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 0.5) +
  labs(title='Scatterplot RAM dengan Price\n',
    x = "\nRam (GB)", y = "Ribu IDR\n", color = "Storage Type") +
  theme3.2 +
  geom_text(aes(x = 100, 
                y = 100000, 
                label = paste("R =", round(cor(data$`Ram (GB)`, 
                                               data$`Price (IDR)`), 2))),
            color = "black", size = 20)
chart
#Export Chart
ggsave("05.5_Scatteplot RAM (GB) degan Price.png", 
       chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

# CPU {.tabset}

![](https://i.pinimg.com/1200x/80/8a/dd/808add313799cff1f67ab7e0f9f11905.jpg)

## Bar Chart CPU Brand

### Variasi {.tabset}

#### Vertikal

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`CPU Brand`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n))   # Urutkan
chart <-
ggplot(data = gg.data,
       aes(x = reorder(`CPU Brand`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$`CPU Brand` == 'Intel',  "#1D4B83",
                         ifelse(gg.data$`CPU Brand` == 'AMD',  "#E06C26",
                         "#dddddd"))) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nCPU Brand", y = "Persentase (%)\n", 
       title = "Bar CPU Brand Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
chart
#Export Chart
ggsave("06.1_Bar Chart CPU Brand Laptop.png", chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Hozizontal

```{r dpi=300, fig.height = 20, fig.width = 17, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data, #buat persentase
       aes(x = reorder(`CPU Brand`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill= ifelse(gg.data$`CPU Brand` == 'Intel',  "#1D4B83",
                         ifelse(gg.data$`CPU Brand` == 'AMD',  "#E06C26",
                         "#dddddd"))) +
  labs(x = "\nBrand", y = "Persentase (%)", 
       title = "Sebaran CPU Brand Laptop\n") + coord_flip() +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 10)) + theme1.2 
chart 
#Export Chart
ggsave("06.2_Bar Chart CPU Brand Laptop_Horizontal.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 17)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran CPU Score

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data, aes(x=`CPU Score`, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#E06C26', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#1D4B83', color='black',
                     outlier.size=2, outlier.color='#1D4B83', 
                     notch=T, width=0.2) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nCPU Score", y='',
       title = "Sebaran CPU Score Laptop") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`CPU Score`) , y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`CPU Score`) , 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#1D4B83", 
    fill = "white", box.color = "#1D4B83", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`CPU Score`) , 
                   xend = mean(data$`CPU Score`) , 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("06.2_Sebaran CPU Score Laptop.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran CPU Score Per CPU Brand

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$`CPU Brand` <- factor(data$`CPU Brand`, 
                  levels= data %>% count(`CPU Brand`) %>% 
                                        arrange(n, desc(`CPU Brand`)) %>%
                                        pull(`CPU Brand`) )
chart <- 
ggplot(data, aes(x=`CPU Score`, y=`CPU Brand`, fill=`CPU Brand`)) + 
  geom_density_ridges(alpha=0.85) +
  #COLORING
  scale_fill_manual(values =c(Intel = "#1D4B83", AMD = "#d65c2d",
                              Apple = "#777D91",  Mediatek = '#F7B747')) +
  labs(x = "\nCPU Score",y = "CPU Brand\n", 
       title = "Sebaran CPU Score Per CPU Brand\n") + theme2 + theme(legend.position = "none") +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1,
  label = "<b>Tidak ada sebaran</b> pada merek <b>Qualcomm</b> \n\n karena hanya memiliki <b> satu data</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.15, size = 7, fill=NA
)


chart
#Export Chart
ggsave("06.3_Sebaran CPU Score Per CPU Brand.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran CPU Score Per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`CPU Score`, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.85, #Opacity
                     begin = 0.5, #Color pallte scale begins
                     end = 0.8, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "B") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nCPU Score",y = "Brand Laptop\n", 
       title = "Sebaran CPU Score per Brand Laptop \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7, fill=NA
)

chart
#Export Chart
ggsave("06.4_Sebaran CPU Score per Brand Laptop .png", 
       chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Scatterplot CPU & Price

```{r dpi=300, fig.height = 20, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
scat.cpu <-
ggplot(data = data, aes(x = `CPU Score`, y = `Price (IDR)`/1000)) +
  geom_point(alpha = 0.5, size = 7, col="#d65c2d") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 0.5) +
  labs(title='Scatterplot CPU Score dengan Price\n',
    x = "\nCPU Score", y = "Ribu IDR\n", color = "Storage Type") +
  theme3.2 +
  geom_text(aes(x = 100, 
                y = 100000, 
                label = paste("R =", round(cor(data$`CPU Score`, 
                                               data$`Price (IDR)`), 2))),
            color = "black", size = 20)
scat.cpu
#Export Chart
ggsave("06.5_Scatteplot CPU Score degan Price.png", 
       scat.cpu, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

# GPU {.tabset}

![](https://www.yangcanggih.com/wp-content/uploads/2022/09/Nvidia-RTX-4090-yangcanggih.webp)

## Bar Chart GPU Brand

### Variasi {.tabset}

#### Vertikal

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
# Membuat bar chart persentase
gg.data <- data %>%
            count(`GPU Brand`) %>% # banyaknya laptop brand x
                  mutate(perc = round(n / sum(n) * 100)) %>% #buat persentase, 
                  arrange(desc(n)) %>%   # Urutkan
                  mutate(top1 = row_number() <= 1) # Top 1 n terbanyak
gpu_brand <-
ggplot(data = gg.data,
       aes(x = reorder(`GPU Brand`, -n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$`GPU Brand` == 'Intel',  "#1D4B83",
                         ifelse(gg.data$`GPU Brand` == 'NVIDIA',  "#84C441",
                           ifelse(gg.data$`GPU Brand` == 'AMD',  "#DA1F27",
                           "#dddddd")
                            )
                         )
           ) +
  geom_text(aes(label = prettyNum(n,big.mark = ",")
                ), vjust = -0.5, size = 8, col="orange4", 
            fontface = "bold") + # Tambahkan label
  labs(x = "\nGPU Brand", y = "Persentase (%)\n", 
       title = "Bar GPU Brand Laptop\n") +
  scale_y_continuous(labels = scales::percent_format(scale = 1)) +
  theme1.1
gpu_brand
#Export Chart
ggsave("07.1_Bar Chart GPU Brand Laptop_Urut.png", gpu_brand, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

#### Horizontal

```{r dpi=300, fig.height = 20, fig.width = 17, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = gg.data, #buat persentase
       aes(x = reorder(`GPU Brand`, n), y = perc)) +
  geom_bar(stat = "identity", col=NA,
           fill = ifelse(gg.data$`GPU Brand` == 'Intel',  "#1D4B83",
                         ifelse(gg.data$`GPU Brand` == 'NVIDIA',  "#84C441",
                           ifelse(gg.data$`GPU Brand` == 'AMD',  "#DA1F27",
                           "#dddddd")
                            )
                         )
           ) +
  labs(x = "\n GPU Brand", y = "Persentase (%)", 
       title = "Sebaran GPU Brand Laptop\n") + coord_flip() +
  scale_y_continuous(labels = scales::percent_format(scale = 1),
                     expand = c(0, 10)) + theme1.2 
chart 
#Export Chart
ggsave("07.2_Bar Chart GPU Brand Laptop_Horizontal.png", chart, path = export.chart,
        dpi = 300, height = 20, width = 17)
```

## Sebaran

### Variasi {.tabset}

#### Sebaran GPU Score

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data, aes(x=`GPU Score`, 
                     y='')) +
  #Violin
  geom_violin(scale="count", fill='#84C441', color='black', alpha=0.9, 
                    trim = FALSE) +
  #Boxplot
  geom_boxplot(fill='#2C68AF', color='black',
                     outlier.size=2, outlier.color='#2C68AF', 
                     notch=T, width=0.1, alpha=0.5) +
  #Mean Marker
  stat_summary(fun = mean, geom = "point", shape = 16, size = 4, 
               color = "cyan2") +
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nGPU Score", y='',
       title = "Sebaran GPU Score Laptop") + theme2 +
  #Tambah Mean Value
  geom_richtext(
    data = data.frame(x = mean(data$`GPU Score`) , y = 1.25, 
                      label = paste("Mean:", 
                                    round(mean(data$`GPU Score`) , 
                                          2))),
    aes(x, y, label = label), size = 7, color = "#2C68AF", 
    fill = "white", box.color = "#2C68AF", parse = TRUE
  ) +
  #Tambah panah
  geom_segment(aes(x = mean(data$`GPU Score`) , 
                   xend = mean(data$`GPU Score`) , 
                   y = 1, 
                   yend = 1.225), 
               arrow = arrow(type = "closed", length = unit(0.1, "inches")), 
               lineend = "round", color = "cyan2")
chart
#Export Chart
ggsave("07.1_Sebaran GPU Score Laptop.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran GPU Score per GPU Brand

```{r dpi=300, fig.height = 10, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$`GPU Brand` <- factor(data$`GPU Brand`, 
                  levels= data %>% count(`GPU Brand`) %>% 
                                        arrange(n, desc(`GPU Brand`)) %>%
                                        pull(`GPU Brand`) )
chart <- 
ggplot(data, aes(x=`GPU Score`, y=`GPU Brand`, fill=`GPU Brand`)) + 
  geom_density_ridges(alpha=0.75) +
  #COLORING
  scale_fill_manual(values =c(Intel = "#1D4B83", AMD = "#DA1F27",
                              NVIDIA = "#84C441",  Apple = '#777D91',
                              ARM = '#35A8CA', Imagination='#71256B')) +
  labs(x = "\nGPU Score",y = "GPU Brand\n", 
       title = "Sebaran GPU Score Per GPU Brand\n") + theme2 + theme(legend.position = "none") +
  annotate(
  geom = "richtext",
  x = -Inf, y = 0.7,
  label = "<b>Tidak ada sebaran</b> pada merek <b>Qualcomm</b> \n\n karena hanya memiliki <b> satu data</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.15, size = 7, fill=NA
)


chart
#Export Chart
ggsave("07.4_Sebaran GPU Score Per GPU Brand.png", chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

#### Sebaran GPU Score per Laptop Brand

```{r dpi=300, fig.height = 14, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
data$Brand <- factor(data$Brand, 
                  levels= data %>% count(Brand) %>% 
                                        arrange(n, desc(Brand)) %>%
                                        pull(Brand) )
chart <- 
ggplot(data, aes(x=`GPU Score`, y=Brand, fill=Brand)) + 
  geom_density_ridges() +
  #COLORING
  scale_fill_viridis(alpha = 0.75, #Opacity
                     begin = 0.4, #Color pallte scale begins
                     end = 0.8, #Color pallte scale ends
                     direction = -1, #Flip color scale
                     discrete = T, #Discrete Value
                     option = "D") + #Color Palette
  theme(plot.title = element_text(hjust=0.5),legend.position = "none") +
  labs(x = "\nGPU Score",y = "Brand Laptop\n", 
       title = "Sebaran GPU Score per Brand Laptop \n") + theme2 +
  annotate(
  geom = "richtext",
  x = -Inf, y = 1.25,
  label = "<b>Tidak ada sebaran</b> pada merek laptop <b>Toshiba</b>, <b>Chuwi</b>, dan <b>Fusion5</b>\n\n karena jumlah data untuk ketiga merek tersebut sangat terbatas, yaitu <b>kurang dari 3</b>.",
  vjust = 0, label.padding = unit(0.2, "lines"),
  parse = TRUE,
  hjust = -0.1, size = 7
)

chart
#Export Chart
ggsave("07.5_Sebaran GPU Score per Brand Laptop .png", 
       chart, path = export.chart,
        dpi = 300, height = 14, width = 20)
```

## Scatterplot GPU & Price

```{r dpi=300, fig.height = 20, fig.width = 20, fig.align = "center", message = FALSE, warning=FALSE}
chart <-
ggplot(data = data, aes(x = `GPU Score`, y = `Price (IDR)`/1000)) +
  geom_point(alpha = 0.5, size = 7, col="#84C441") +
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, size = 0.5) +
  labs(title='Scatterplot GPU Score dengan Price\n',
    x = "\nGPU Score", y = "Ribu IDR\n", color = "Storage Type") +
  theme3.2 +
  geom_text(aes(x = 30, 
                y = 100000, 
                label = paste("R =", round(cor(data$`GPU Score`, 
                                               data$`Price (IDR)`), 2))),
            color = "black", size = 20)
chart
#Export Chart
ggsave("07.5_Scatteplot GPU Score degan Price.png", 
       chart, path = export.chart,
        dpi = 300, height = 10, width = 20)
```

# Referensi

-   GGplot : [Extras](https://towardsdatascience.com/themes-to-spice-up-visualizations-with-ggplot2-3e275038dafa) , [BBplot](https://bbc.github.io/rcookbook/)

-   Notes : [Hanya Orang Gabut yang baca ini](https://github.com/Zen-Rofiqy/STA1381-PSD/blob/main/Proj/Curhat.txt)
